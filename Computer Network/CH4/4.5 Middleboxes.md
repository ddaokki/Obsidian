## Middleboxes와 인터넷 아키텍처

### 🔹 Middlebox란?
- RFC 3234 정의: **일반적인 IP 라우터의 표준 기능 이외의 기능을 수행하는 중간 장비**
- 출발지와 목적지 호스트 사이의 데이터 경로에 위치함

### 🔹 주요 Middlebox 예시
- **NAT**: 홈/기업/모바일 네트워크
- **Firewall, IDS**: 보안 및 침입 탐지 시스템
- **Load Balancer**: 트래픽 분산
- **Cache**: CDN 및 ISP의 응답 속도 개선
- **Application-specific Box**: 특정 애플리케이션용 (예: HTTP 가속기)

---

## Middlebox 기술의 진화

### 🔹 기존 구조
- **폐쇄형(proprietary) 하드웨어** 중심
- 기능 변경이나 확장 어려움

### 🔹 현대적 흐름
- **Whitebox 하드웨어** + 오픈 API 기반
- **Match + Action** 방식으로 **로컬 행동 프로그래밍 가능**
- **SDN 기반**의 중앙 제어 및 설정 관리
- **NFV(Network Function Virtualization)**:
  - 네트워크 기능을 소프트웨어화하여 유연하게 배치 가능

---

## IP Hourglass 구조와의 관계

### 🔹 IP Hourglass 모델
- 얇은 허리(thin waist): **IP 프로토콜**
  - 모든 디바이스가 반드시 구현해야 함
  - 위로는 다양한 앱 계층(TCP/UDP, HTTP, SMTP 등)
  - 아래로는 다양한 링크 계층(Ethernet, WiFi, Bluetooth 등)

### 🔹 Middle Age에서의 변화
- 원래는 IP가 "중립적" 전달자 역할 (end-to-end)
- 하지만 **중간 경로에 Middlebox가 삽입됨**
  - NAT, Firewall, Caching, NFV 등
  - 이는 네트워크 경로 내에서의 **정책 개입**과 **정보 해석**을 의미

---

## 인터넷 설계의 철학 (RFC 1958)

> “The goal is connectivity,  
> the tool is the Internet Protocol,  
> and the intelligence is end to end rather than hidden in the network.”

### 🔹 핵심 원칙 3가지
1. **Simple connectivity** (단순 연결성)
2. **IP as the narrow waist** (중심은 IP)
3. **지능은 네트워크 끝단에** (End-to-End Intelligence)

> 하지만 Middlebox의 등장은 이 원칙과의 긴장 관계를 만들며, 현대 인터넷 설계의 중심적 과제 중 하나가 되었음

## End-to-End Argument

### 개념 정의
- 어떤 네트워크 기능(예: 신뢰성 있는 데이터 전송, 혼잡 제어)은 **네트워크 내부(in-network)** 혹은 **네트워크 끝단(network edge)** 중 어디에서 구현할지를 선택할 수 있음

### 🔹 End-to-End Argument 핵심 내용 (Saltzer, Reed, Clark 1981)
> “해당 기능은 통신 시스템의 종단에 있는 애플리케이션만이 올바르게 구현할 수 있다.  
> 네트워크 내부에서 제공되는 기능은 **불완전하거나 성능 개선 목적에 불과하다**.”

### 🔹 예시
- **End-to-End 구현 방식**: 종단 시스템이 직접 데이터의 신뢰성과 재전송 처리
- **Hop-by-Hop (In-network)** 구현: 각 라우터/노드가 전송 신뢰성 관리

### 🟦 요지
- 기능의 **완전성과 정확성** 보장을 위해서는 끝단에서 처리되어야 함
- 네트워크는 단순한 전송 경로 역할에 집중해야 함

---

## Where’s the Intelligence? – 네트워크 지능의 위치 변화

### 20세기 전화망
- 지능이 **네트워크 내** 스위치 장비에 집중됨

### Internet (2000년대 초반)
- 지능은 **네트워크 가장자리(End)**로 이동
- 예: 사용자 디바이스, 서버가 지능과 제어를 담당

### Internet (2005년 이후)
- **프로그래머블 네트워크 장비(SDN, NFV 등)** 도입
- **엣지 컴퓨팅** 및 **대규모 응용 레벨 인프라** 확장
- 지능과 계산 자원이 다시 분산되고 혼합되는 형태로 진화 중

---

## 종합적 통찰
- End-to-End Argument는 **인터넷 설계의 철학적 근간**을 이룸
- 그러나 **현대 네트워크(Middlebox, SDN, NFV)**는 기존 철학과 실용적 요구 사이의 균형점을 찾고자 함

